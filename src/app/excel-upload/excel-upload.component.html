<form>
  <label for="inputFile" class="input-label">Upload Excel file</label><br />
  <input
    type="file"
    id="inputFile"
    appUploadExcel
    (eventEmitter)="DataFromEventEmitter($event)"
    accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
  />
</form>
<hr>
<div>
  <p>Total Rows: {{validatedData.length}}</p><br>
  <p *ngIf="!isTableValid" class="invalid">Table contains some invalid data.</p>
</div>
<hr />
<table *ngIf="excelData">
  <!--<span *ngFor="let item of excelData | keyvalue"></span>
  [className]="row.pincode ==='INVALID' || row.pincode === undefined ? 'invalid' : ''"
  -->
  <tr>
    <th>SL No.</th>
    <th>Firstname</th>
    <th>Lastname</th>
    <th>Gender</th>
    <th>Country</th>
    <th>Mobile</th>
    <th>pincode</th>
    <th style="width:25%">Feedback</th>
  </tr>

  <tr *ngFor="let row of validatedData" >

    <td [className]="row.sl_no == undefined || row.sl_no.error? 'invalid': ''"
    >{{ row.sl_no == undefined || row.sl_no.error?  row.sl_no==undefined? 'Empty cell': row.sl_no.value   :row.sl_no }}</td>

    <td [className]="row.firstname== undefined || row.firstname.error? 'invalid': ''"
    >{{ row.firstname == undefined || row.firstname.error?  row.firstname==undefined? 'Empty cell': row.firstname.value   :row.firstname }}</td>

    <td  [className]="row.lastname== undefined || row.lastname.error? 'invalid': ''" 
    >{{ row.lastname == undefined || row.lastname.error?  row.lastname==undefined? 'Empty cell': row.lastname.value   :row.lastname}}</td>

    <td [className]="row.gender== undefined || row.gender.error? 'invalid': ''"
    >{{ row.gender == undefined || row.gender.error?  row.gender==undefined? 'Empty cell': row.gender.value   :row.gender}}</td>

    <td [className]="row.country== undefined || row.country.error? 'invalid': ''"
    >{{ row.country == undefined || row.country.error?  row.country==undefined? 'Empty cell': row.country.value   :row.country }}</td>

    <td [className]="row.mobile== undefined || row.mobile.error? 'invalid': ''"
    >{{row.mobile == undefined || row.mobile.error?  row.mobile==undefined? 'Empty cell': row.mobile.value   :row.mobile}}</td>

    <td [className]="row.pincode== undefined || row.pincode.error? 'invalid': ''"
    >{{ row.pincode == undefined || row.pincode.error?  row.pincode==undefined? 'Empty cell': row.pincode.value   :row.pincode}}</td>

    <td class="table-data-error">
      {{row.sl_no == undefined || row.sl_no.error ? row.sl_no == undefined ?'Sl.no shouldn\'t be empty':row.sl_no.error : '' }} <br>
      {{row.firstname == undefined || row.firstname.error ? row.firstname == undefined ?'Firstname shouldn\'t be empty':row.firstname.error : '' }}<br>
      {{row.lastname == undefined || row.lastname.error ? row.lastname == undefined ?'Lastname shouldn\'t be empty':row.lastname.error : '' }}<br>
      {{row.gender == undefined || row.gender.error ? row.gender == undefined ?'gender shouldn\'t be empty':row.gender.error : '' }}<br>
      {{row.country == undefined || row.country.error ? row.country == undefined ?'country shouldn\'t be empty':row.country.error : '' }}<br>
      {{row.mobile == undefined || row.mobile.error ? row.mobile == undefined ?'Mobile shouldn\'t be empty':row.mobile.error : '' }}<br>
      {{row.pincode == undefined || row.pincode.error ? row.pincode == undefined ?'Pincode shouldn\'t be empty':row.pincode.error : '' }}<br>
      
    </td>
  
  </tr>

  <!-- <tr *ngFor="let row of validatedData">
    <td [className]="row.sl_no == undefined || row.sl_no.error? 'invalid': ''"
    >{{ row.sl_no.error? row.sl_no.value:row.sl_no }}</td>
    <td >{{ row.firstname.error? row.firstname.value:row.firstname }}</td>
    <td >{{ row.lastname.error? row.lastname.value:row.lastname}}</td>
    <td >{{ row.gender.error? row.gender.value:row.gender}}</td>
    <td >{{ row.country == undefined || row.country.error?  row.country==undefined? 'Empty cell': row.country.value   :row.country }}</td>
    <td >{{row.mobile.error?row.mobile.value:row.mobile}}</td>
    <td >{{ row.pincode.error?row.pincode.value:row.pincode}}</td>
  </tr> -->
 
</table>



